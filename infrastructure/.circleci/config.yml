version: 2.1

workflows:
  api_handler_tf:
    when: << pipeline.parameters.tf-dev_api_handler >>
    jobs:
      - init:
          target-env: "sand/dshah"
          appName   : "api_handler"
          context: 
            - cicd-aws-user-creds
      - plan-apply:
          target-env: "sand/dshah"
          appName   : "api_handler"
          context: 
            - dshah-aws-user-creds
          requires:
            - init
  partner_profile_tf:
    when: << pipeline.parameters.tf-dev_partner_profile >>
    jobs:
      - init:
          target-env: "sand/dshah"
          appName   : "partner_profile"
          context: 
            - cicd-aws-user-creds
      - plan-apply:
          target-env: "sand/dshah"
          appName   : "partner_profile"
          context: 
            - dshah-aws-user-creds
          requires:
            - init
