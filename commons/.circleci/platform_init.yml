executors:
  default:
    docker:
      - image: hashicorp/terraform:1.2.7

jobs:
  init:
    parameters:
      target-env:
        type: string
      appName:
        type: string
    executor: default
    steps:
      - checkout
      - check_tf
      - terraform/init:
          path: infrastructure/<<parameters.appName>>/<<parameters.target-env>>
      - terraform/fmt:
          path: infrastructure/<<parameters.appName>>/<<parameters.target-env>>
      - terraform/validate:
          path: infrastructure/<<parameters.appName>>/<<parameters.target-env>>
